.\" Man page generated from reStructuredText.
.
.TH SSHGUARD 8 "August 16, 2016" "2.0.0" "SSHGuard Manual"
.SH NAME
sshguard \- block brute-force attacks by aggregating system logs
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.\" Copyright (c) 2007,2008,2009,2010 Mij <mij@sshguard.net>
.
.\" Permission to use, copy, modify, and distribute this software for any
.
.\" purpose with or without fee is hereby granted, provided that the above
.
.\" copyright notice and this permission notice appear in all copies.
.
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.
.SH SYNOPSIS
.sp
\fBsshguard\fP [\fB\-v\fP] [\fB\-h\fP]
[\fB\-a\fP \fIblacklist\-threshold\fP]
[\fB\-b\fP \fIblacklist\-file\fP]
[\fB\-i\fP \fIpid\-file\fP]
[\fB\-p\fP \fIblock\-time\fP]
[\fB\-s\fP \fIdetection\-time\fP]
[\fB\-w\fP \fIaddress\fP | \fIfile\fP]
[\fIfile\fP ...]
.SH DESCRIPTION
.sp
\fBsshguard\fP protects hosts from brute\-force attacks against SSH and other
services. It aggregates system logs and blocks repeat offenders using one of
several firewall backends, including \fBfirewalld\fP, \fBipfw\fP, \fBipset\fP,
\fBiptables\fP and \fBpf\fP\&.
.sp
\fBsshguard\fP can read log messages from standard input (suitable for piping
from \fBsyslog\fP or \fBjournalctl\fP) or monitor one or more log files. Log
messages are parsed, line\-by\-line, for recognized patterns. If an attack,
such as several login failures within a few seconds, is detected, the
offending IP is blocked. Offenders are unblocked after a set interval, but
can be semi\-permanently banned using the blacklist option.
.sp
See \fI\%http://www.sshguard.net/docs/setup/\fP for setup instructions.
.sp
Other features, attack signatures, and additional documentation can be found
at \fI\%http://www.sshguard.net/\fP\&.
.SH OPTIONS
.INDENT 0.0
.TP
.B \fB\-a\fP \fIblacklist\-threshold\fP (default 30)
Block an attacker when its dangerousness exceeds \fIblacklist\-threshold\fP\&.
Each attack pattern that is matched contributes a fixed dangerousness
of 10.
.TP
.B \fB\-b\fP \fIblacklist\-file\fP
Blacklist an attacker when its dangerousness exceeds \fIblacklist\-threshold\fP\&.
Blacklisted addresses are added to \fIblacklist\-file\fP so they can be read at
the next startup. Blacklisted addresses are never automatically unblocked,
but it is good practice to periodically clean out stale blacklist entries.
.TP
.B \fB\-i\fP \fIpid\-file\fP
Write the PID of \fBsshguard\fP to \fIpidfile\fP\&.
.TP
.B \fB\-p\fP \fIblock\-time\fP (default 120 secs, or 2 minutes)
Wait at least \fIblock\-time\fP seconds before releasing a blocked address.
Repeat attackers are blocked for 1.5 times longer after each attack.
Because \fBsshguard\fP unblocks attackers only at infrequent intervals,
this parameter is inexact (actual blocks will be longer).
.TP
.B \fB\-s\fP \fIdetection\-time\fP (default 1800 secs, or 30 minutes)
Forget about an attacker \fIdetection\-time\fP seconds after its last attempt.
Its  dangerousness will be reset to zero.
.TP
.B \fB\-w\fP \fIip\-address\fP | \fIwhitelist\-file\fP
Whitelist the given address, hostname, or address block. Alternatively,
read whitelist entires from \fIwhitelist\-file\fP\&. This option can be given
multiple times. See WHITELISTING below for details.
.TP
.B \fB\-h\fP
Print usage information and exit.
.TP
.B \fB\-v\fP
Print version information and exit.
.UNINDENT
.SH ENVIRONMENT
.INDENT 0.0
.TP
.B SSHGUARD_DEBUG
Enable additional debugging information.
.UNINDENT
.SH WHITELISTING
.sp
\fBsshguard\fP supports IP address whitelisting. Whitelisted addresses are not
blocked even if they appear to generate attacks. This is useful for protecting
lame LAN users (or external friendly users) from being incidentally blocked.
.sp
Whitelist addresses are controlled through the \-w command\-line option. This
option can add explicit addresses, host names and address blocks:
.INDENT 0.0
.TP
.B addresses
specify the numeric IPv4 or IPv6 address directly, like:
.INDENT 7.0
.INDENT 3.5
.sp
.nf
.ft C
\-w 192.168.1.10
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
or in multiple occurrences:
.INDENT 7.0
.INDENT 3.5
.sp
.nf
.ft C
\-w 192.168.1.10 \-w 2001:0db8:85a3:0000:0000:8a2e:0370:7334
.ft P
.fi
.UNINDENT
.UNINDENT
.TP
.B host names
specify the host name directly, like:
.INDENT 7.0
.INDENT 3.5
.sp
.nf
.ft C
\-w friendhost.enterprise.com
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
or in multiple occurrences:
.INDENT 7.0
.INDENT 3.5
.sp
.nf
.ft C
\-w friendhost.enterprise.com \-w friend2.enterprise.com
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
All IPv4 and IPv6 addresses that the host resolves to are whitelisted. Hosts
are resolved to addresses once, when \fBsshguard\fP starts up.
.TP
.B address blocks
specify the IPv4 or IPv6 address block in the usual CIDR notation:
.INDENT 7.0
.INDENT 3.5
.sp
.nf
.ft C
\-w 2002:836b:4179::836b:0000/126
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
or in multiple occurrences:
.INDENT 7.0
.INDENT 3.5
.sp
.nf
.ft C
\-w 192.168.0.0/24 \-w 1.2.3.128/26
.ft P
.fi
.UNINDENT
.UNINDENT
.TP
.B file
When longer lists are needed for whitelisting, they can be wrapped into a
plain text file, one address/hostname/block per line, with the same syntax
given above.
.sp
\fBsshguard\fP can take whitelists from files when the \-w option argument begins
with a \(aq.\(aq (dot) or \(aq/\(aq (slash).
.sp
This is a sample whitelist file (say /etc/friends):
.INDENT 7.0
.INDENT 3.5
.sp
.nf
.ft C
# comment line (a \(aq#\(aq as very first character)
#   a single IPv4 and IPv6 address
1.2.3.4
2001:0db8:85a3:08d3:1319:8a2e:0370:7344
#   address blocks in CIDR notation
127.0.0.0/8
10.11.128.0/17
192.168.0.0/24
2002:836b:4179::836b:0000/126
#   hostnames
rome\-fw.enterprise.com
hosts.friends.com
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
And this is how \fBsshguard\fP is told to make a whitelist up from the
/etc/friends file:
.INDENT 7.0
.INDENT 3.5
.sp
.nf
.ft C
sshguard \-w /etc/friends
.ft P
.fi
.UNINDENT
.UNINDENT
.UNINDENT
.sp
The \-w option can be used only once for files. For addresses, host names and
address blocks it can be used with any multiplicity, even with mixes of them.
.SH SEE ALSO
.sp
Glossary: \fI\%http://www.sshguard.net/docs/terminology/\fP
.sp
Website: \fI\%http://www.sshguard.net/\fP
.sp
\fBsshguard.conf.sample\fP
.SH AUTHORS
.sp
Michele Mazzucchi <\fI\%mij@bitchx.it\fP>,
T.J. Jones <\fI\%tjjones03@gmail.com\fP>,
Kevin Zheng <\fI\%kevinz5000@gmail.com\fP>
.\" Generated by docutils manpage writer.
.
