#!/bin/sh
# sshg-fw -- control firewall backends
# This file is part of SSHGuard.

@sshg_fw_subr@

fw_init
if [ $? -ne 0 ]; then
    echo "Could not initialize firewall" >&2
    exit 1
fi

while [ true ]; do
    read cmd address addrtype
    case $cmd in
        block)
            fw_block $address $addrtype;;
        release)
            fw_release $address $addrtype;;
        flush)
            fw_flush;;
        *)
            break;;
    esac
done

fw_fin
