#!/bin/sh
# sshg-fw -- control firewall backends
# This file is part of SSHGuard.

@sshg_fw_subr@

fw_log() {
    logger -p auth.debug -t sshg-fw
}

fw_init
if [ $? -ne 0 ]; then
    echo "Could not initialize firewall; check permissions and firewall setup" >&2
    exit 1
fi

while [ true ]; do
    read cmd address addrtype
    if [ "$cmd" == "block" ]; then
        fw_block $address $addrtype
    elif [ "$cmd" == "release" ]; then
        fw_release $address $addrtype
    elif [ "$cmd" == "flush" ]; then
        fw_flush
    else
        break
    fi
done

fw_fin
